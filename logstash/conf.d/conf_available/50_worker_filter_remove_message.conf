# this filter removes message field in case that it's properly parsed  
filter {
	if "_grokparsefailure" not in [tags] {
		mutate {
			remove_field => [ "message" ]
		}
	}
	# if field App_message is present, trucate it to 1024B
	if ("" in [App_message]) {
		ruby {
			code => 'event.set("App_message",event.get("App_message")[0..1024]+" ... Truncated by logstsash (1024B)") if event.get("App_message").bytesize > 1024'
		}
	}
	# Change host to Unix_Hostname for all messages
	mutate {
		rename => [ "host", "Unix_Hostname" ]
	}
}
